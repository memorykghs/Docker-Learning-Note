# 08.3 - Docker 網路相關指令

## docker exec
下面會很常用到 `docker exec` 指令，為了在執行中的容器內執行命令，原本需要在映像檔中新增 SSH Server，現在直接使用 `docker exec` 即可。
```docker
docker exec [OPTIONS] CONTAINER COMMAND [ARG...]
```

| 引數名 | 簡寫 | 描述 |
| --- | :---: | --- |
| `-detach` | `-d` | 分離模式：在後臺執行命令 |
| `-detach-keys` | | 重寫分離容器的鍵序列 |
| `-env` | `-e` | 設定環境變數 |
| `-interactive` | `-i` | 即使沒有連線，也要保持 STDIN 開啟 |
| `-privileged` | | 賦予命令擴充套件特權 |
| `-tty` | `-t` | 分配一個偽 tty |
| `-user` | `-u` | 使用者名稱或 UID |
| `-workdir` | `-w` | 指定容器內的工作目錄 |

有幾點需要注意：
* 執行的指令只會在容器預設的目錄中執行，如果基礎映像檔中有使用 `WORKDIR` 指令自定義目錄，將會在這個指定目錄下執行。

## 取得 Windows Container 使用的 IP

```docker
# docker exec -it ${container_name || container_id} ipconfig
docker exec -it e86fg8a ipconfig
```

## 取得 Linux Container 內部 IP
```docker
# docker exec -it ${container_name || container_id} ifconfig
docker exec -it e86fg8a ifconfig
```

如果出現了像面這樣的結果，代表容器未安裝 `ifconfig` 指令，這樣就要透過其他方式來取得 IP。
![](/images/docker/8.3-1.png)

#### 方法一
```docker
# docker inspect -f '{{range .NetworkSettings.Networks}}{{.IPAddress}}{{end}}' ${container_name || container_id}
docker inspect -f '{{range .NetworkSettings.Networks}}{{.IPAddress}}{{end}}' e86fg8a
```

#### 方法二

* PowerShell
```docker
docker inspect ${container_name || container_id} | findstr 'IPAdress'
```

* bash
```docker
docker inspect ${container_name || container_id} | grep '"IPAddress"' | head -n 1
```
![](/images/docker/8.3-2.png)

## 參考
* https://blog.yowko.com/container-ip/

#### docker exec
* https://iter01.com/607806.html
* https://blog.yowko.com/container-ip/